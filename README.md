# MAX EDU - Система управления образовательным учреждением

Полнофункциональная микросервисная система для управления образовательным учреждением, включающая веб-интерфейс, MAX-бота и REST API для всех основных процессов.

## Архитектура системы

Система построена на микросервисной архитектуре и состоит из следующих компонентов:

### Backend микросервисы

1. **Auth Service** (порт 8001) - Аутентификация и авторизация
2. **Staff Service** (порт 8002) - Управление студентами и преподавателями
3. **Timetable Service** (порт 8003) - Расписание занятий
4. **Applicants Service** (порт 8004) - Управление абитуриентами
5. **Events Service** (порт 8005) - Мероприятия
6. **Library Service** (порт 8006) - Библиотека
7. **Certificates Service** (порт 8007) - Справки и сертификаты

### Frontend

- **Frontend** (порт 80) - React приложение с Tailwind CSS

### Bot

- **MAX Bot** - MAX бот для взаимодействия с системой

### Базы данных

Каждый микросервис использует отдельную PostgreSQL базу данных:
- `postgres_auth` (порт 5433)
- `postgres_staff` (порт 5434)
- `postgres_timetable` (порт 5435)
- `postgres_applicants` (порт 5436)
- `postgres_events` (порт 5437)
- `postgres_library` (порт 5438)
- `postgres_certificates` (порт 5439)


## Быстрый старт

### 1. Клонирование репозитория

```bash
git clone <repository-url>
cd app
```

### 2. ⚠️ ВАЖНО: Настройка переменных окружения для бота

**Перед запуском необходимо создать файл `.env` в корне проекта** с переменными окружения для MAX бота:

```env
BOT_TOKEN=your_MAX_bot_token_here
BASE_URL=localhost <- укажите именно эти значения для локального запуска
AUTH_USERNAME=admin <- укажите именно эти значения для локального запуска
AUTH_PASSWORD=admin123 <- укажите именно эти значения для локального запуска
```
### 3. Запуск всех сервисов через Docker Compose

```bash
docker-compose up -d
```

Эта команда запустит:
- Все базы данных PostgreSQL
- Все микросервисы
- Frontend приложение
- MAX бот (используя переменные из `.env` файла)

### 4. ⚠️ КРИТИЧЕСКИ ВАЖНО: Создание тестового пользователя для работы с ботом

**После запуска всех сервисов необходимо создать тестового пользователя в системе для работы с MAX ботом!**

#### Почему это важно:
- Бот использует авторизацию по номеру телефона
- Без создания пользователя с вашим номером телефона авторизация в боте **не пройдет**
- Интерфейс отображения в боте различается для студентов, преподавателей и абитуриентов

#### Как создать тестового пользователя:

1. **Войдите в веб-интерфейс:**
   - Откройте `http://localhost`
   - Войдите с учетными данными администратора:
     - Логин: `admin`
     - Пароль: `admin123`

2. **Создайте пользователя одного из типов:**

   **Вариант А: Создание студента**
   - Перейдите в раздел "Управление"
   - Нажмите "Добавить студента"
   - **Обязательно укажите ваш реальный номер телефона** в формате `+7XXXXXXXXXX` (11 цифр после +7)
   - Заполните остальные поля (имя, группа, факультет и т.д.)
   - Сохраните

   **Вариант Б: Создание преподавателя**
   - Перейдите в раздел "Управление"
   - Нажмите "Добавить преподавателя"
   - **Обязательно укажите ваш реальный номер телефона** в формате `+7XXXXXXXXXX` (11 цифр после +7)
   - Заполните остальные поля (имя, кафедра и т.д.)
   - Сохраните

   **Вариант В: Создание абитуриента**
   - Перейдите в раздел "Абитуриентам"
   - Нажмите "Добавить абитуриента"
   - **Обязательно укажите ваш реальный номер телефона** в формате `+7XXXXXXXXXX` (11 цифр после +7)
   - Заполните остальные поля (имя, СНИЛС, программа и т.д.)
   - Сохраните

3. **Проверьте работу бота:**
   - Откройте MAX бота в мессенджере
   - Отправьте команду `/start` или любое сообщение
   - Введите уникальный ID (это либо номер студенческого, либо номер преподавателя, либо ID-абитуриента который отображается в интерфейсе)
   - Бот должен распознать вас по номеру телефона и показать соответствующий интерфейс:
     - **Студенты** - интерфейс студента (расписание, библиотека и т.д.)
     - **Преподаватели** - интерфейс преподавателя (расписание, студенты и т.д.)
     - **Абитуриенты** - интерфейс абитуриента (рейтинг, документы и т.д.)

## Доступ к системе

### Веб-интерфейс

После запуска фронтенд доступен по адресу:
```
http://localhost
```
### Тестовые учетные данные

**Важно:** При первом запуске автоматически создается тестовый администратор:

- **Логин:** `admin`
- **Пароль:** `admin123`

Используйте эти учетные данные для входа в систему через веб-интерфейс.

## Управление контейнерами

### Остановка всех сервисов

```bash
docker-compose down
```

### Остановка с удалением volumes (базы данных)

```bash
docker-compose down -v
```

**Внимание:** Это удалит все данные из баз данных!

## Структура проекта

```
backend/
├── auth/              # Сервис аутентификации
├── staff/             # Сервис управления персоналом
├── timetable/         # Сервис расписания
├── applicants/       # Сервис абитуриентов
├── events/           # Сервис мероприятий
├── library/          # Сервис библиотеки
├── certificates/     # Сервис сертификатов
├── frontend/          # React фронтенд приложение
├── bot/              # MAX бот
└── docker-compose.yml # Конфигурация Docker Compose
```

## Документация микросервисов

Подробная документация по каждому микросервису доступна в соответствующих README файлах:

- [Auth Service](auth/README.md) - Аутентификация и авторизация
- [Staff Service](staff/README.md) - Управление студентами и преподавателями
- [Timetable Service](timetable/README.md) - Расписание занятий
- [Applicants Service](applicants/README.md) - Управление абитуриентами
- [Events Service](events/README.md) - Мероприятия
- [Library Service](library/README.md) - Библиотека
- [Certificates Service](certificates/README.md) - Сертификаты
- [Frontend](frontend/README.md) - Веб-интерфейс