#  AIOMAX - –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

##  –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1.  –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
-  –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–∑ VCF —Ñ–æ—Ä–º–∞—Ç–∞
-  –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—è `vcf_info` –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
  ```
  updates -> attachments -> payload -> vcf_info -> TEL;TYPE=cell:–ù–û–ú–ï–†
  ```
-  –ù–æ–º–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ `ContactAttachment.vcf_phone`

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `aiomax/types.py` - –æ–±–Ω–æ–≤–ª—ë–Ω `ContactAttachment.from_json()`

### 2.  –†–∞—Å—à–∏—Ä–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è:
- `BotBlockedByUser` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞
- `RateLimitException` - –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å retry_after)
- `InvalidRequestException` - –Ω–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- `NetworkError` - —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ç–∞–π–º–∞—É—Ç—ã
- `MessageTooLongException` - —Ç–µ–∫—Å—Ç –ø—Ä–µ–≤—ã—à–∞–µ—Ç 4000 —Å–∏–º–≤–æ–ª–æ–≤
- `ChatAdminRequiredException` - –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `aiomax/exceptions.py` - –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- `aiomax/utils.py` - —É–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –æ—à–∏–±–æ–∫
- `aiomax/bot.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤

### 3.  –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä

–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ —Å—Ç–∏–ª–µ aiogram:
- `button(text, callback_data=None, url=None)` - –ø—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
- `adjust(*sizes)` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –ø–æ —Ä—è–¥–∞–º
- `quick_keyboard(*specs)` - –±—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–∑ –∫–æ—Ä—Ç–µ–∂–µ–π
- `inline_keyboard(*rows)` - —Å–æ–∑–¥–∞–Ω–∏–µ –∏–∑ –≥–æ—Ç–æ–≤—ã—Ö —Ä—è–¥–æ–≤

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `aiomax/buttons.py` - –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏

### 4.  –£–ª—É—á—à–µ–Ω–Ω–∞—è FSM (–∫–∞–∫ –≤ aiogram)

-  –ö–ª–∞—Å—Å—ã `State` –∏ `StatesGroup` –¥–ª—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
-  –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã FSMCursor:
  - `set_state()` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ
  - `update_data(**kwargs)` - –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–¥–æ–±–∞–≤–ª—è–µ—Ç –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º)
  - `get_value(key, default)` - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  - `set_value(key, value)` - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
  - `finish()` - –∑–∞–≤–µ—Ä—à–∏—Ç—å FSM
-  –§–∏–ª—å—Ç—Ä `state()` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏–π

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `aiomax/fsm.py` - –¥–æ–±–∞–≤–ª–µ–Ω—ã `State`, `StatesGroup`, –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã
- `aiomax/filters.py` - —É–ª—É—á—à–µ–Ω —Ñ–∏–ª—å—Ç—Ä `state()`
- `aiomax/__init__.py` - —ç–∫—Å–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤

### 5.  –£–ª—É—á—à–µ–Ω–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

-  –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤ (`asyncio.TimeoutError`)
-  –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ (`aiohttp.ClientError`)
-  –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `raise ... from` –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
-  –í—Å–µ HTTP –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç —Å–±–æ–µ–≤

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
- `aiomax/bot.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ –≤–æ –≤—Å–µ—Ö HTTP –º–µ—Ç–æ–¥–∞—Ö

##  –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ `docs/`:

####  `docs/FSM.md`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ `State` –∏ `StatesGroup`
- –û–ø–∏—Å–∞–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã FSMCursor
- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –Ω–æ–≤—ã–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º

####  `docs/–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã.md`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –º–µ—Ç–æ–¥–∞–º `button()` –∏ `adjust()`
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `quick_keyboard()` –∏ `inline_keyboard()`

####  `docs/–¢–∏–ø—ã.md`
- –û–±–Ω–æ–≤–ª—ë–Ω —Ä–∞–∑–¥–µ–ª `ContactAttachment`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É –∏–∑–≤–ª–µ—á–µ–Ω–∏—é –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ü—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

####  `docs/–ü—Ä–∏–º–µ—Ä—ã.md`
- –ü—Ä–∏–º–µ—Ä—ã –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞ —Å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- –ü—Ä–∏–º–µ—Ä—ã FSM —Å –Ω–æ–≤—ã–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–æ–º

##  –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

### `main.py`
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –±–æ—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏:
-  –£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
-  –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
-  FSM —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º StatesGroup
-  –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–Ω–æ–ø–æ–∫

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ö–æ–º–∞–Ω–¥–∞ `/start` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- –ö–æ–º–∞–Ω–¥–∞ `/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å FSM
- –ö–æ–º–∞–Ω–¥–∞ `/contact` - –∑–∞–ø—Ä–æ—Å –∫–æ–Ω—Ç–∞–∫—Ç–∞
- –ö–æ–º–∞–Ω–¥–∞ `/menu` - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ –¥–µ–º–æ-–±–æ—Ç–∞

```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ main.py
# 2. –ó–∞–º–µ–Ω–∏—Ç–µ 'TOKEN' –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω
# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ
python main.py
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞

```python
from aiomax.buttons import KeyboardBuilder, ContactButton

@bot.on_command('contact')
async def request_contact(ctx):
    kb = KeyboardBuilder()
    kb.add(ContactButton("–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–º"))
    await ctx.send("–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–Ω—Ç–∞–∫—Ç–æ–º:", keyboard=kb)

@bot.on_message()
async def handle_contact(message):
    for attachment in message.body.attachments:
        if attachment.type == "contact":
            phone = attachment.vcf_phone  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
            print(f"–ù–æ–º–µ—Ä: {phone}")
```

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä

```python
from aiomax.buttons import KeyboardBuilder

kb = KeyboardBuilder()
kb.button("–ö–Ω–æ–ø–∫–∞ 1", callback_data="btn1")
kb.button("–ö–Ω–æ–ø–∫–∞ 2", callback_data="btn2")
kb.button("–°—Å—ã–ª–∫–∞", url="https://example.com")
kb.adjust(2, 1)  # –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ —Ä—è–¥–∞–º
```

### 4. FSM

```python
from aiomax.fsm import StatesGroup, State

class MyStates(StatesGroup):
    name = State()
    age = State()

@bot.on_command("start")
async def start(ctx, cursor):
    cursor.set_state(MyStates.name)
    await ctx.send("–ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?")

@bot.on_message(filters.state(MyStates.name))
async def process_name(message, cursor):
    cursor.update_data(name=message.body.text)
    cursor.set_state(MyStates.age)
```

##  –ò—Ç–æ–≥–∏

### –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:
-  `aiomax/types.py` - –ø–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
-  `aiomax/exceptions.py` - –Ω–æ–≤—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
-  `aiomax/utils.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
-  `aiomax/buttons.py` - –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –∫–ª–∞–≤–∏–∞—Ç—É—Ä
-  `aiomax/fsm.py` - State –∏ StatesGroup
-  `aiomax/filters.py` - —É–ª—É—á—à–µ–Ω–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä state
-  `aiomax/bot.py` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
-  `aiomax/__init__.py` - —ç–∫—Å–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
-  `docs/FSM.md`
-  `docs/–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã.md`
-  `docs/–¢–∏–ø—ã.md`
-  `docs/–ü—Ä–∏–º–µ—Ä—ã.md`

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
-  `main.py` - –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –±–æ—Ç
-  `QUICKSTART.md` - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
-  `UPDATES.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

##  –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

-  [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/)
-  [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](QUICKSTART.md)
-  [–î–µ–º–æ-–±–æ—Ç](main.py)
-  [MAX API](https://dev.max.ru/docs-api)

##  –£–ª—å—Ç—Ä–∞-–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ª–æ–≥–∏ —Å–æ–±—ã—Ç–∏–π

–õ–æ–≥–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å–∞–º–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –≤ —É–ª—å—Ç—Ä–∞-–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ:
- **ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π** –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω (–¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏)
- **–û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ** –±–µ–∑ –ª–∏—à–Ω–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- **–û—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è** –±–µ–∑ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π

### –ü—Ä–∏–º–µ—Ä —É–ª—å—Ç—Ä–∞-–º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö –ª–æ–≥–æ–≤:

```
 123456 - message
 123456 - command /start
 123456 - button 'register'
 123456 - contact_received
 123456 - fsm_state_change
```

---

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ AIOMAX –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

